<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:jaas="http://karaf.apache.org/xmlns/jaas/v1.1.0">

    <jaas:config name="karaf" rank="2">
        <jaas:module className="de.hf.dac.security.auth.modules.LdapLoginModule" flags="required">
            java.naming.provider.url = ${auth.ldap.url}
            bindDN = ${auth.ldap.user}
            bindCredential = ${auth.ldap.credentials}
            baseCtxDN = ${auth.ldap.baseCtxDN}
            searchTimeLimit = 30000
            baseFilter = (sAMAccountName={0})
            password-stacking = useFirstPass
            storePass = true
            useFirstPass = false
            rolesCtxDN = ${auth.ldap.rolesCtxDN}
            roleFilter = (sAMAccountName={0})
            roleAttributeID = memberOf
            roleAttributeIsDN = true
            roleNameAttributeID = cn
            roleRecursion = -1
            searchScope = ONELEVEL_SCOPE
            allowEmptyPasswords = false
            principalClass = org.apache.karaf.jaas.boot.principal.UserPrincipal
            debug = false
        </jaas:module>
        <jaas:module className="de.hf.dac.security.auth.modules.LdapLoginModule" flags="required">
            java.naming.provider.url = ${role.ldap.url}
            bindDN = ${role.ldap.user}
            bindCredential = ${role.ldap.credentials}
            baseCtxDN = ${role.ldap.baseCtxDN}
            baseFilter = (dzuid={0})
            rolesCtxDN = ${role.ldap.rolesCtxDN}
            roleFilter = (uniqueMember={1})
            roleAttributeID = cn
            permissionAttributeID = dzpermissions
            searchScope = ONELEVEL_SCOPE
            allowEmptyPasswords = false
            useFirstPass = true
            permissionRoleMapping = ${role.mappings}
            userAttributes = ${role.userAttributes}
            debug = false
        </jaas:module>
    </jaas:config>
</blueprint>
